<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jogo da Forca com PyScript</title>

  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>

  <style>
    body {
      background: #121212;
      color: #eee;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 2rem;
    }
    #forcaCanvas {
      background: #222;
      border: 2px solid #555;
      margin: 0 auto 1rem;
      display: block;
      border-radius: 10px;
    }
    #palavra {
      font-size: 2rem;
      letter-spacing: 1rem;
      margin-bottom: 1rem;
      user-select: none;
    }
    #letrasErradas {
      color: #f00;
      font-weight: bold;
      min-height: 1.2rem;
    }
    #mensagem {
      margin-top: 1rem;
      font-weight: bold;
      min-height: 1.5rem;
    }
    input, button {
      font-size: 1.3rem;
      padding: 0.5rem;
      margin: 0.3rem;
      border-radius: 6px;
      border: none;
      outline: none;
    }
    input {
      width: 3rem;
      text-align: center;
    }
    button {
      background: #00bcd4;
      color: #121212;
      cursor: pointer;
      font-weight: bold;
    }
    button:disabled {
      background: #555;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

  <h1>Jogo da Forca</h1>

  <canvas id="forcaCanvas" width="250" height="250"></canvas>

  <div id="palavra">_ _ _ _ _</div>

  <div>Letras erradas: <span id="letrasErradas"></span></div>

  <input type="text" id="inputLetra" maxlength="1" autocomplete="off" placeholder="Letra" />
  <button id="btnTentar" py-click="jogo.tentar_letra()">Tentar</button>

  <div id="mensagem"></div>

  <py-script>
import random
from js import document

class JogoForca:
    def __init__(self):
        self.palavras = ["python", "forca", "codigo", "pyscript", "github"]
        self.palavra = random.choice(self.palavras)
        self.letras_certas = ["_" for _ in self.palavra]
        self.letras_erradas = []
        self.erros = 0
        self.max_erros = 6

        self.canvas = document.getElementById("forcaCanvas")
        self.ctx = self.canvas.getContext("2d")

        self.atualizar_tela()

    def desenhar_forca(self):
        ctx = self.ctx
        ctx.clearRect(0, 0, self.canvas.width, self.canvas.height)
        ctx.strokeStyle = "#00bcd4"
        ctx.lineWidth = 3
        if self.erros >= 1:
            ctx.beginPath()
            ctx.moveTo(20, 230)
            ctx.lineTo(230, 230)
            ctx.stroke()
        if self.erros >= 2:
            ctx.beginPath()
            ctx.moveTo(50, 230)
            ctx.lineTo(50, 20)
            ctx.stroke()
        if self.erros >= 3:
            ctx.beginPath()
            ctx.moveTo(50, 20)
            ctx.lineTo(180, 20)
            ctx.stroke()
        if self.erros >= 4:
            ctx.beginPath()
            ctx.moveTo(180, 20)
            ctx.lineTo(180, 50)
            ctx.stroke()
        if self.erros >= 5:
            ctx.beginPath()
            ctx.arc(180, 70, 20, 0, 6.28318)
            ctx.stroke()
        if self.erros >= 6:
            ctx.beginPath()
            ctx.moveTo(180, 90)
            ctx.lineTo(180, 150)
            ctx.stroke()

    def atualizar_tela(self):
        document.getElementById("palavra").innerText = " ".join(self.letras_certas)
        document.getElementById("letrasErradas").innerText = ", ".join(self.letras_erradas)
        self.desenhar_forca()

    def tentar_letra(self, *args):
        input_letra = document.getElementById("inputLetra")
        letra = input_letra.value.lower()
        input_letra.value = ""
        msg = document.getElementById("mensagem")

        if len(letra) != 1 or not letra.isalpha():
            msg.innerText = "Digite uma única letra válida."
            return

        if letra in self.letras_certas or letra in self.letras_erradas:
            msg.innerText = f"Você já tentou a letra '{letra}'."
            return

        if letra in self.palavra:
            for idx, ch in enumerate(self.palavra):
                if ch == letra:
                    self.letras_certas[idx] = letra
            msg.innerText = "Letra correta!"
        else:
            self.letras_erradas.append(letra)
            self.erros += 1
            msg.innerText = "Letra errada!"

        self.atualizar_tela()

        if "_" not in self.letras_certas:
            msg.innerText = f"Parabéns! Você venceu! Palavra: {self.palavra.upper()}"
            document.getElementById("btnTentar").disabled = True
            input_letra.disabled = True
        elif self.erros >= self.max_erros:
            msg.innerText = f"Você perdeu! A palavra era: {self.palavra.upper()}"
            document.getElementById("btnTentar").disabled = True
            input_letra.disabled = True

jogo = JogoForca()
  </py-script>

</body>
</html>

